<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سيف الإسلام - مهندس برمجيات ومبدع مونتاج</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Changa:wght@600;700&family=Tajawal:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glow-color: #00ff89;
            --secondary-glow-color: #9400ff;
            --glow-color-rgb: 0, 255, 137;
            --bg-color: #010206;
            --text-color: #e0e0e0;
            --card-bg: rgba(10, 15, 25, 0.65);
            --border-color: rgba(0, 255, 137, 0.25);
            --input-bg: rgba(0, 0, 0, 0.3);
        }
        /* --- الأساسيات والمؤشر --- */
        body {
            background-color: var(--bg-color); color: var(--text-color);
            font-family: 'Tajawal', sans-serif; overflow: hidden; margin: 0; cursor: none;
        }
        #cursor-dot, #cursor-ring { position: fixed; left: 0; top: 0; pointer-events: none; z-index: 9999; transition: opacity 0.3s; }
        #cursor-dot { width: 8px; height: 8px; background-color: var(--glow-color); border-radius: 50%; transform: translate(-50%, -50%); transition: transform 0.1s ease-out, opacity 0.3s; }
        #cursor-ring { width: 40px; height: 40px; border: 2px solid var(--glow-color); border-radius: 50%; transform: translate(-50%, -50%); transition: transform 0.2s ease-out, width 0.3s, height 0.3s, border-color 0.3s, opacity 0.3s; }
        /* --- شاشة التحميل --- */
        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-color); z-index: 10000; display: flex; align-items: center; justify-content: center; transition: opacity 1s ease-out 0.5s; }
        .spinner {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 9px solid;
            border-color: var(--glow-color) #0000;
            animation: spinner-anim 0.8s infinite linear;
        }
        @keyframes spinner-anim { to { transform: rotate(1turn); } }
        /* --- الهيكل الرئيسي --- */
        #three-canvas { position: fixed; top: 0; left: 0; outline: none; z-index: 1; }
        #main-content { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; overflow-y: auto; opacity: 0; pointer-events: none; transition: opacity 1s ease-in; scrollbar-width: thin; scrollbar-color: var(--glow-color) transparent; }
        #main-content::-webkit-scrollbar { width: 6px; }
        #main-content::-webkit-scrollbar-track { background: transparent; }
        #main-content::-webkit-scrollbar-thumb { background-color: var(--glow-color); border-radius: 6px; }
        .content-section { padding: 8rem 1rem; max-width: 1100px; margin: 0 auto; position: relative; z-index: 2; }
        .header-section { min-height: 100vh; display: flex; align-items: center; justify-content: center; text-align: center; }
        /* --- البطاقات الزجاجية --- */
        .glass-card { background: var(--card-bg); border: 1px solid var(--border-color); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-radius: 24px; transition: all 0.4s ease; box-shadow: 0 0 20px rgba(0,0,0,0.5), inset 0 0 15px rgba(var(--glow-color-rgb), 0.1); transform-style: preserve-3d; }
        .glass-card:hover { transform: translateY(-8px) scale(1.02); border-color: rgba(var(--glow-color-rgb), 0.7); box-shadow: 0 0 35px rgba(var(--glow-color-rgb), 0.2), inset 0 0 25px rgba(var(--glow-color-rgb), 0.2); }
        /* --- الخطوط وعناصر الواجهة --- */
        .font-display { font-family: 'Changa', sans-serif; font-weight: 700; }
        .text-glow { color: var(--glow-color); text-shadow: 0 0 4px rgba(var(--glow-color-rgb), 0.7), 0 0 12px rgba(var(--glow-color-rgb), 0.5), 0 0 24px rgba(var(--glow-color-rgb), 0.3); }
        .form-input { background: var(--input-bg); border: 1px solid var(--border-color); color: var(--text-color); border-radius: 12px; padding: 0.75rem 1rem; transition: all 0.3s ease; }
        .form-input:focus { outline: none; border-color: var(--glow-color); box-shadow: 0 0 15px rgba(var(--glow-color-rgb), 0.5); }
        .cyber-button { position: relative; background: transparent; border: 2px solid var(--glow-color); color: var(--glow-color); border-radius: 12px; padding: 0.75rem 1.5rem; transition: all 0.4s; overflow: hidden; font-family: 'Changa', sans-serif; text-shadow: 0 0 5px var(--glow-color); }
        .cyber-button:hover { color: #010206; background: var(--glow-color); box-shadow: 0 0 25px var(--glow-color); }
        .star-rating { display: flex; flex-direction: row-reverse; justify-content: flex-end; }
        .star-rating input { display: none; }
        .star-rating label { font-size: 2rem; color: #444; cursor: none; transition: color 0.2s; }
        .star-rating input:checked ~ label, .star-rating label:hover, .star-rating label:hover ~ label { color: var(--glow-color); text-shadow: 0 0 10px var(--glow-color); }
        /* --- حركة الظهور عند التمرير --- */
        .reveal-on-scroll { opacity: 0; transform: translateY(50px); transition: opacity 1s ease-out, transform 1s ease-out; }
        .reveal-on-scroll.is-visible { opacity: 1; transform: translateY(0); }
    </style>
</head>
<body>
    <div id="cursor-dot"></div>
    <div id="cursor-ring"></div>

    <div id="loading-screen">
        <div class="spinner"></div>
    </div>

    <canvas id="three-canvas"></canvas>

    <main id="main-content">
        <header class="header-section content-section">
            <div id="header-text-container" class="text-center">
                 <h1 class="font-display text-6xl md:text-8xl lg:text-9xl text-glow" id="main-title" style="opacity: 0;">سيف الإسلام</h1>
                 <p class="mt-4 text-xl md:text-3xl font-light tracking-wider" id="subtitle" style="opacity: 0;">مهندس برمجيات ومبدع مونتاج</p>
            </div>
        </header>

        <section id="about" class="content-section">
            <div class="glass-card p-8 md:p-12 text-center reveal-on-scroll" data-tilt>
                <h2 class="font-display text-4xl md:text-5xl text-glow mb-6">الرؤية المزدوجة</h2>
                <p class="text-lg md:text-xl leading-relaxed max-w-3xl mx-auto">أعيش في عالمين: عالم الشيفرة الدقيقة وعالم السرد البصري. كمهندس برمجيات، أبني حلولاً تقنية قوية. وكمبدع مونتاج، أصنع قصصاً مؤثرة. هذا المزيج الفريد يمكنني من تحويل أي فكرة إلى تجربة رقمية متكاملة وجذابة.</p>
            </div>
        </section>

        <section id="skills" class="content-section">
            <h2 class="font-display text-4xl md:text-5xl text-glow mb-12 text-center reveal-on-scroll">ترسانة المهارات</h2>
            <div id="skills-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8">
                </div>
        </section>

        <section id="portfolio" class="content-section">
            <h2 class="font-display text-4xl md:text-5xl text-glow mb-12 text-center reveal-on-scroll">معرض الأعمال</h2>
            <div id="portfolio-grid" class="space-y-16">
                </div>
        </section>

        <section id="reviews" class="content-section">
            <h2 class="font-display text-4xl md:text-5xl text-glow mb-12 text-center reveal-on-scroll">آراء العملاء</h2>
            <div id="reviews-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12"></div>
            <div class="glass-card p-8 reveal-on-scroll" data-tilt>
                <h3 class="font-display text-3xl text-glow mb-6 text-center">أضف شهادتك</h3>
                <form id="review-form" class="space-y-6">
                     </form>
            </div>
        </section>
        
        <section id="contact" class="content-section">
            <h2 class="font-display text-4xl md:text-5xl text-glow mb-12 text-center reveal-on-scroll">تواصل معي</h2>
            <div class="glass-card p-8 reveal-on-scroll" data-tilt>
                <form id="service-request-form" class="space-y-6">
                     </form>
            </div>
        </section>

        <footer class="text-center py-8 mt-12 text-gray-500">
            <p>&copy; 2025 سيف الإسلام. تم التصميم والبرمجة بحب وشغف.</p>
        </footer>
    </main>

    <script type="importmap">
        { "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.module.js", "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/", "gsap": "https://unpkg.com/gsap@3.12.5/index.js" } }
    </script>
    <script type="module">
        // --- استيراد الوحدات ---
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
        import { gsap } from 'gsap';

        // --- الإعدادات العامة والمتغيرات ---
        let مشهد, كاميرا, عارض, مُلحن_المؤثرات, مؤشر_الفأرة;
        const مجموعة_الخلفية = new THREE.Group();
        const كائنات_ثلاثية_الأبعاد = new THREE.Group();
        const رابط_جوجل_سكريبت = 'https://script.google.com/macros/s/AKfycbwwuLKpOhx1YmWl1bezEc7aJF2kgPwIwazWhqzYuEj4XO6Aa0TZDAHBeAWClhKCByXo2w/exec';
        
        // --- عناصر الواجهة الرسومية (DOM) ---
        const شاشة_التحميل = document.getElementById('loading-screen');
        const المحتوى_الرئيسي = document.getElementById('main-content');
        const نقطة_المؤشر = document.getElementById('cursor-dot');
        const حلقة_المؤشر = document.getElementById('cursor-ring');
        const العنوان_الرئيسي = document.getElementById('main-title');
        const العنوان_الفرعي = document.getElementById('subtitle');

        // --- البيانات ---
        const بيانات_المهارات = [
            { name: 'تطوير الويب', icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.636 18.364a9 9 0 010-12.728m12.728 0a9 9 0 010 12.728m-9.9-2.829a5 5 0 010-7.07m7.072 0a5 5 0 010 7.07M12 6v.01M12 12v.01M12 18v.01"></path>` },
            { name: 'تطوير الجوال', icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>` },
            { name: 'برامج سطح المكتب', icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>` },
            { name: 'مونتاج إبداعي', icon: `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"></path>` }
        ];

        const بيانات_معرض_الأعمال = [
            { type: 'video', title: 'عينة الفيديو 1', url: 'https://www.youtube.com/embed/KeBKMOAs_a8' },
            { type: 'video', title: 'عينة الفيديو 2', url: 'https://www.youtube.com/embed/1wgL00xdLrU' },
            { type: 'video', title: 'عينة الفيديو 3', url: 'https://www.youtube.com/embed/Ego8GVwLw_o' },
            { type: 'video', title: 'عينة الفيديو 4', url: 'https://www.youtube.com/embed/MIwTS0pxr28' },
            { type: 'image', title: 'ملفات الصور', images: [
                { url: 'https://res.cloudinary.com/dz4xwjvif/image/upload/v1752048960/%D8%B9%D8%B7%D9%88%D8%B1_%D8%A7%D9%84%D8%B4%D8%B1%D9%82_%D8%A7%D9%84%D8%A3%D9%88%D8%B3%D8%B7_%D9%84%D9%88%D8%AC%D9%88_zie0b1.jpg', alt: 'تصميم عطور' },
                { url: 'https://res.cloudinary.com/dz4xwjvif/image/upload/v1752049216/Logo_halwa_al_qodes_2_jd6nyb.jpg', alt: 'تصميم حلوى' },
                { url: 'https://res.cloudinary.com/dz4xwjvif/image/upload/v1752168394/%D8%AF%D9%84%D9%8A%D9%84_%D8%A7%D9%84%D8%B1%D9%8A%D8%A7%D8%B6_%D8%A7%D9%84%D8%A3%D9%88%D9%84_2_dkx2wl.jpg', alt: 'تصميم دليل الرياض' },
                { url: 'https://res.cloudinary.com/dz4xwjvif/image/upload/v1752167786/%D8%AF%D9%84%D9%8A%D9%84_%D8%A7%D9%84%D8%B1%D9%8A%D8%A7%D8%B6_%D8%A7%D9%84%D8%B4%D8%A7%D9%85%D9%84_ddjrb7.jpg', alt: 'تصميم دليل الرياض' },
                { url: 'https://res.cloudinary.com/dz4xwjvif/image/upload/v1752049317/1752033860076_si3ycq.png', alt: 'تصميم دراجات' }
            ]},
            { type: 'video', title: 'إعلانات UGC إبداعية', url: 'https://player.cloudinary.com/embed/?cloud_name=dz4xwjvif&public_id=ai_masri_good_hrvboy' },
            { type: 'video', title: 'إعلان عيادة تجميل', url: 'https://player.cloudinary.com/embed/?cloud_name=dz4xwjvif&public_id=ayon_al_amira_w19lmf' }
        ];

        // --- الدوال الرئيسية ---
        function تهيئة() {
            إعداد_المشهد();
            إعداد_المؤثرات_البصرية();
            إعداد_خلفية_المجرات();
            إعداد_الكائنات_ثلاثية_الأبعاد();
            
            عرض_المهارات();
            عرض_معرض_الأعمال();
            عرض_نموذج_المراجعة();
            عرض_نموذج_التواصل();
            جلب_وعرض_المراجعات();

            إضافة_معالجات_الأحداث();
            بدء_التجربة();
            تحريك();
        }

        // --- دوال الإعداد ---
        function إعداد_المشهد() {
            مشهد = new THREE.Scene();
            مؤشر_الفأرة = new THREE.Vector2();
            
            const نسبة_العرض_إلى_الارتفاع = window.innerWidth / window.innerHeight;
            كاميرا = new THREE.PerspectiveCamera(75, نسبة_العرض_إلى_الارتفاع, 0.1, 1000);
            كاميرا.position.z = 5;
            
            عارض = new THREE.WebGLRenderer({ canvas: document.getElementById('three-canvas'), antialias: true });
            عارض.setSize(window.innerWidth, window.innerHeight);
            عارض.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            عارض.setClearColor(0x010206, 1);
        }

        function إعداد_المؤثرات_البصرية() {
            const ممر_العرض = new RenderPass(مشهد, كاميرا);
            const ممر_التوهج = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.2, 0.4, 0.85);
            
            مُلحن_المؤثرات = new EffectComposer(عارض);
            مُلحن_المؤثرات.addPass(ممر_العرض);
            مُلحن_المؤثرات.addPass(ممر_التوهج);
        }

        function إعداد_خلفية_المجرات() {
            const عدد_الجسيمات = 5000;
            const مواقع = new Float32Array(عدد_الجسيمات * 3);
            for (let i = 0; i < عدد_الجسيمات; i++) {
                مواقع[i * 3 + 0] = (Math.random() - 0.5) * 20;
                مواقع[i * 3 + 1] = (Math.random() - 0.5) * 20;
                مواقع[i * 3 + 2] = (Math.random() - 0.5) * 20;
            }
            const هندسة_الجسيمات = new THREE.BufferGeometry();
            هندسة_الجسيمات.setAttribute('position', new THREE.BufferAttribute(مواقع, 3));
            
            const مادة_الجسيمات = new THREE.PointsMaterial({ color: 0x00ff89, size: 0.02, transparent: true, blending: THREE.AdditiveBlending, depthWrite: false });
            const جسيمات = new THREE.Points(هندسة_الجسيمات, مادة_الجسيمات);
            مجموعة_الخلفية.add(جسيمات);
            مشهد.add(مجموعة_الخلفية);
        }
        
        function إعداد_الكائنات_ثلاثية_الأبعاد() {
            const هندسة_المكعب = new THREE.BoxGeometry(1, 1, 1, 2, 2, 2);
            const هندسة_الإطار = new THREE.WireframeGeometry(هندسة_المكعب);
            const مادة_الإطار = new THREE.LineBasicMaterial({ color: 0x00ff89, linewidth: 2, transparent: true, opacity: 0.5 });
            const مكعب_مهارات = new THREE.LineSegments(هندسة_الإطار, مادة_الإطار);
            مكعب_مهارات.position.set(-3, 8, -2);
            مكعب_مهارات.name = 'مكعب_المهارات';
            كائنات_ثلاثية_الأبعاد.add(مكعب_مهارات);

            const شكل_التشغيل = new THREE.Shape();
            شكل_التشغيل.moveTo(0, 0.6); شكل_التشغيل.lineTo(0, -0.6); شكل_التشغيل.lineTo(1, 0); شكل_التشغيل.lineTo(0, 0.6);
            const هندسة_التشغيل = new THREE.ShapeGeometry(شكل_التشغيل);
            const مادة_التشغيل = new THREE.MeshBasicMaterial({ color: 0x9400ff, side: THREE.DoubleSide, transparent: true, opacity: 0.7 });
            const أيقونة_تشغيل = new THREE.Mesh(هندسة_التشغيل, مادة_التشغيل);
            أيقونة_تشغيل.position.set(3, 22, -3);
            أيقونة_تشغيل.rotation.y = -Math.PI / 4;
            أيقونة_تشغيل.name = 'أيقونة_التشغيل';
            كائنات_ثلاثية_الأبعاد.add(أيقونة_تشغيل);
            
            مشهد.add(كائنات_ثلاثية_الأبعاد);
        }

        // --- دوال عرض المحتوى الديناميكي ---
        function عرض_المهارات() {
            const حاوية = document.getElementById('skills-grid');
            بيانات_المهارات.forEach((مهارة, فهرس) => {
                const بطاقة = `<div class="glass-card p-6 text-center flex flex-col items-center justify-center reveal-on-scroll" data-tilt style="transition-delay: ${فهرس * 100}ms;"><svg class="w-16 h-16 mb-4" style="color: var(--glow-color);" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">${مهارة.icon}</svg><h3 class="font-display text-xl">${مهارة.name}</h3></div>`;
                حاوية.innerHTML += بطاقة;
            });
        }
        
        function عرض_معرض_الأعمال() {
            const حاوية = document.getElementById('portfolio-grid');
            بيانات_معرض_الأعمال.forEach((عمل, فهرس) => {
                let محتوى_البطاقة = '';
                if (عمل.type === 'video') {
                    محتوى_البطاقة = `<h3 class="font-display text-3xl text-glow mb-6">${عمل.title}</h3><div class="aspect-w-16 aspect-h-9 rounded-xl overflow-hidden border-2 border-transparent hover:border-green-400 transition-all duration-300"><iframe src="${عمل.url}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="rounded-lg"></iframe></div>`;
                } else if (عمل.type === 'image') {
                    const صور_html = عمل.images.map(صورة => `<img src="${صورة.url}" alt="${صورة.alt}" class="w-full h-full object-cover rounded-lg transform hover:scale-105 transition-transform duration-300">`).join('');
                    محتوى_البطاقة = `<h3 class="font-display text-3xl text-glow mb-6">${عمل.title}</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-4">${صور_html}</div>`;
                }
                const عنصر = `<div class="glass-card p-8 reveal-on-scroll" data-tilt style="transition-delay: ${فهرس * 150}ms;">${محتوى_البطاقة}</div>`;
                حاوية.innerHTML += عنصر;
            });
        }
        
        function عرض_نموذج_المراجعة() {
             document.getElementById('review-form').innerHTML = `<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><input type="text" name="name" placeholder="الاسم" required class="form-input"><input type="text" name="project" placeholder="نوع المشروع" required class="form-input"></div><textarea name="review" placeholder="شهادتك..." required class="form-input w-full" rows="4"></textarea><div class="flex flex-col items-center"><p class="mb-2">تقييمك:</p><div class="star-rating"><input type="radio" id="5-stars" name="rating" value="5" /><label for="5-stars">★</label><input type="radio" id="4-stars" name="rating" value="4" /><label for="4-stars">★</label><input type="radio" id="3-stars" name="rating" value="3" /><label for="3-stars">★</label><input type="radio" id="2-stars" name="rating" value="2" /><label for="2-stars">★</label><input type="radio" id="1-star" name="rating" value="1" /><label for="1-star">★</label></div></div><button type="submit" class="cyber-button w-full mt-4">إرسال الشهادة</button>`;
        }

        function عرض_نموذج_التواصل() {
            document.getElementById('service-request-form').innerHTML = `<div class="grid grid-cols-1 md:grid-cols-2 gap-6"><input type="text" id="contact-name" name="name" placeholder="الاسم الكامل" required class="form-input"><input type="email" id="contact-email" name="email" placeholder="البريد الإلكتروني" required class="form-input"></div><select id="contact-service" name="service" class="form-input w-full"><option>اختر نوع الخدمة</option><option value="تطوير ويب">تطوير ويب</option><option value="تطوير جوال">تطوير جوال</option><option value="مونتاج فيديو">مونتاج فيديو</option><option value="تصميم جرافيك">تصميم جرافيك</option><option value="استشارة">استشارة</option></select><textarea id="contact-details" name="details" placeholder="تفاصيل المشروع..." required class="form-input w-full" rows="5"></textarea><button type="submit" class="cyber-button w-full">إرسال الطلب عبر واتساب</button>`;
        }

        // --- الحركات والتفاعلات ---
        function بدء_التجربة() {
            شاشة_التحميل.style.opacity = '0';
            شاشة_التحميل.addEventListener('transitionend', () => شاشة_التحميل.style.display = 'none');
            
            المحتوى_الرئيسي.style.opacity = '1';
            المحتوى_الرئيسي.style.pointerEvents = 'auto';

            gsap.timeline()
                .fromTo(العنوان_الرئيسي, { opacity: 0, y: 50, scale: 0.8 }, { opacity: 1, y: 0, scale: 1, duration: 1.5, ease: 'power3.out' })
                .fromTo(العنوان_الفرعي, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 1, ease: 'power2.out' }, "-=1");
        }

        function تطبيق_تأثير_الميلان(عنصر) {
            let إطار_الحركة;
            عنصر.addEventListener('mousemove', (حدث) => {
                if (إطار_الحركة) cancelAnimationFrame(إطار_الحركة);
                إطار_الحركة = requestAnimationFrame(() => {
                    const حدود = عنصر.getBoundingClientRect();
                    const س = حدث.clientX - حدود.left; const ص = حدث.clientY - حدود.top;
                    const نسبة_س = (س / حدود.width - 0.5) * 2; const نسبة_ص = (ص / حدود.height - 0.5) * 2;
                    gsap.to(عنصر, { duration: 0.5, rotationY: 8 * نسبة_س, rotationX: -8 * نسبة_ص, ease: 'power1.out' });
                });
            });
            عنصر.addEventListener('mouseleave', () => {
                gsap.to(عنصر, { duration: 0.8, rotationY: 0, rotationX: 0, ease: 'elastic.out(1, 0.3)' });
            });
        }
        
        // --- معالجة البيانات ---
        async function جلب_وعرض_المراجعات() {
            try {
                const استجابة = await fetch(`${رابط_جوجل_سكريبت}?action=read`);
                const بيانات = await استجابة.json();
                const حاوية = document.getElementById('reviews-list');
                حاوية.innerHTML = '';
                بيانات.forEach((مراجعة, فهرس) => {
                    if (!مراجعة.name || !مراجعة.review) return;
                    let نجوم = '★'.repeat(مراجعة.rating || 5) + '☆'.repeat(5 - (مراجعة.rating || 5));
                    const بطاقة = `<div class="glass-card p-6 reveal-on-scroll" data-tilt style="transition-delay: ${فهرس * 100}ms;"><p class="text-xl font-bold mb-2">${مراجعة.name}</p><p class="text-sm text-gray-400 mb-3">${مراجعة.project}</p><p class="mb-4">"${مراجعة.review}"</p><div class="text-yellow-400 text-xl">${نجوم}</div></div>`;
                    حاوية.innerHTML += بطاقة;
                });
                تفعيل_كل_تأثيرات_الميلان();
            } catch (خطأ) { console.error('فشل في جلب المراجعات:', خطأ); }
        }
        
        // --- معالجات الأحداث ---
        function إضافة_معالجات_الأحداث() {
            window.addEventListener('resize', عند_تغيير_حجم_النافذة);
            window.addEventListener('mousemove', عند_تحريك_الفأرة);
            المحتوى_الرئيسي.addEventListener('scroll', معالجة_التمرير);

            document.getElementById('review-form').addEventListener('submit', إرسال_المراجعة);
            document.getElementById('service-request-form').addEventListener('submit', إنشاء_رابط_واتساب);
            تفعيل_كل_تأثيرات_الميلان();
        }

        function تفعيل_كل_تأثيرات_الميلان() {
            document.querySelectorAll('[data-tilt]').forEach(تطبيق_تأثير_الميلان);
        }

        function عند_تغيير_حجم_النافذة() {
            كاميرا.aspect = window.innerWidth / window.innerHeight;
            كاميرا.updateProjectionMatrix();
            عارض.setSize(window.innerWidth, window.innerHeight);
            مُلحن_المؤثرات.setSize(window.innerWidth, window.innerHeight);
            عارض.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        }

        function عند_تحريك_الفأرة(حدث) {
            مؤشر_الفأرة.x = (حدث.clientX / window.innerWidth) * 2 - 1;
            مؤشر_الفأرة.y = -(حدث.clientY / window.innerHeight) * 2 + 1;
            gsap.to(نقطة_المؤشر, { duration: 0.1, x: حدث.clientX, y: حدث.clientY });
            gsap.to(حلقة_المؤشر, { duration: 0.3, x: حدث.clientX, y: حدث.clientY });
        }

        function معالجة_التمرير() {
            document.querySelectorAll('.reveal-on-scroll').forEach(عنصر => {
                if (عنصر.getBoundingClientRect().top < window.innerHeight - 100) {
                    عنصر.classList.add('is-visible');
                }
            });
            const نسبة_التمرير = المحتوى_الرئيسي.scrollTop / (المحتوى_الرئيسي.scrollHeight - window.innerHeight);
            كائنات_ثلاثية_الأبعاد.position.y = -نسبة_التمرير * 30;
        }

        async function إرسال_المراجعة(حدث) {
            حدث.preventDefault();
            const نموذج = حدث.target, زر = نموذج.querySelector('button'), نص_الزر_الأصلي = زر.textContent;
            زر.textContent = 'جارٍ الإرسال...'; زر.disabled = true;
            try {
                await fetch(`${رابط_جوجل_سكريبت}?action=create`, { method: 'POST', body: new URLSearchParams(new FormData(نموذج)) });
                نموذج.reset(); زر.textContent = 'تم الإرسال بنجاح!';
                await جلب_وعرض_المراجعات();
            } catch (خطأ) { زر.textContent = 'حدث خطأ!'; } 
            finally { setTimeout(() => { زر.textContent = نص_الزر_الأصلي; زر.disabled = false; }, 3000); }
        }

        function إنشاء_رابط_واتساب(حدث) {
            حدث.preventDefault();
            const رسالة = `مرحباً سيف،\nأنا ${document.getElementById('contact-name').value}.\n\nأرغب في طلب خدمة: *${document.getElementById('contact-service').value}*.\n\nالتفاصيل:\n${document.getElementById('contact-details').value}`;
            window.open(`https://wa.me/966503901416?text=${encodeURIComponent(رسالة)}`, '_blank');
        }

        // --- دورة التحديث الرئيسية ---
        const ساعة = new THREE.Clock();
        function تحريك() {
            requestAnimationFrame(تحريك);
            const الزمن_المنقضي = ساعة.getElapsedTime();
            مجموعة_الخلفية.rotation.y = الزمن_المنقضي * 0.05;
            مجموعة_الخلفية.rotation.x = الزمن_المنقضي * 0.02;

            const مكعب_المهارات = كائنات_ثلاثية_الأبعاد.getObjectByName('مكعب_المهارات');
            if(مكعب_المهارات) { مكعب_المهارات.rotation.x = الزمن_المنقضي * 0.3; مكعب_المهارات.rotation.y = الزمن_المنقضي * 0.3; }
            
            const أيقونة_التشغيل = كائنات_ثلاثية_الأبعاد.getObjectByName('أيقونة_التشغيل');
            if(أيقونة_التشغيل) { أيقونة_التشغيل.rotation.y = -Math.PI / 4 + Math.sin(الزمن_المنقضي * 0.5) * 0.5; }

            كاميرا.position.x += (مؤشر_الفأرة.x * 0.5 - كاميرا.position.x) * 0.05;
            كاميرا.position.y += (-مؤشر_الفأرة.y * 0.5 - كاميرا.position.y) * 0.05;
            كاميرا.lookAt(مشهد.position);
            
            مُلحن_المؤثرات.render();
        }

        // --- بدء التنفيذ ---
        document.addEventListener('DOMContentLoaded', تهيئة);
    </script>
</body>
</html>
